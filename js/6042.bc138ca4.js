"use strict";(self.webpackChunkvue_admin_better=self.webpackChunkvue_admin_better||[]).push([["6042"],{14603:function(e,l,a){var o=a(74748),t=a.n(o),i=a(49490),r=a.n(i)()(t());r.push([e.id,".workflow-container[data-v-58babf0a]{padding:20px}.workflow-container .card-header[data-v-58babf0a]{display:flex;justify-content:space-between;align-items:center;font-weight:bold}.workflow-container .workflow-name[data-v-58babf0a]{display:flex;align-items:center}.workflow-container .workflow-description[data-v-58babf0a]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;text-overflow:ellipsis}.workflow-container .workflow-icon-detail[data-v-58babf0a]{text-align:center}.workflow-container .pagination-container[data-v-58babf0a]{margin-top:20px;text-align:right}.workflow-container .node-list .node-item[data-v-58babf0a]{display:flex;align-items:center;margin-bottom:15px;padding:10px;border:1px solid #ebeef5;border-radius:4px}.workflow-container .node-list .node-item .node-handle[data-v-58babf0a]{cursor:move;margin-right:10px;color:#999}.workflow-container .node-list .node-item .node-content[data-v-58babf0a]{flex:1}.workflow-container .node-list .node-item .node-content[data-v-58babf0a] .el-form-item{margin-bottom:10px}.workflow-container .node-list .node-item .node-actions[data-v-58babf0a]{margin-left:10px}.workflow-container .workflow-diagram[data-v-58babf0a]{display:flex;flex-direction:column;align-items:center}.workflow-container .workflow-diagram .workflow-node[data-v-58babf0a]{width:300px;padding:15px;margin:10px 0;border:1px solid #ebeef5;border-radius:4px;cursor:pointer;transition:all .3s}.workflow-container .workflow-diagram .workflow-node[data-v-58babf0a]:hover{box-shadow:0 2px 12px 0 rgba(0,0,0,.1)}.workflow-container .workflow-diagram .workflow-node.active[data-v-58babf0a]{border-color:#409eff;box-shadow:0 0 0 2px #c6e2ff}.workflow-container .workflow-diagram .workflow-node .node-index[data-v-58babf0a]{display:inline-block;width:20px;height:20px;line-height:20px;text-align:center;background-color:#409eff;color:#fff;border-radius:50%;font-size:12px;margin-right:10px}.workflow-container .workflow-diagram .workflow-node .node-name[data-v-58babf0a]{font-weight:bold;margin-bottom:5px}.workflow-container .workflow-diagram .workflow-node .node-assignee[data-v-58babf0a]{font-size:12px;color:#666}",""]),l.Z=r},83506:function(e,l,a){a.r(l),a.d(l,{default:function(){return O}});var o=a(78650);let t={class:"workflow-container"},i={class:"card-header"},r={class:"header-actions"},d={class:"workflow-name"},n={style:{"margin-left":"10px"}},s={class:"workflow-description"},w={class:"workflow-name"},m={style:{"margin-left":"10px"}},u={class:"workflow-name"},f={style:{"margin-left":"10px"}},p={class:"pagination-container"},c={class:"node-list"},g={class:"node-item"},k={class:"node-handle"},b={class:"node-content"},h={class:"node-actions"},W={style:{"margin-top":"15px"}},_={class:"dialog-footer"},y={class:"workflow-diagram"},v=["onClick"],x={class:"node-index"},T={class:"node-name"},V={class:"node-assignee"},C={key:0},U={key:1},z={key:2},F={class:"dialog-footer"};var S=a(57864),D=a(90942),I=a.n(D),$={name:"Workflow",components:{Search:S.Search,Connection:S.Connection,Rank:S.Rank,Delete:S.Delete,draggable:I()},data:()=>({activeTab:"all",workflowActiveTab:"diagram",searchText:"",currentPage:1,pageSize:10,totalWorkflows:0,loading:!1,workflowDialogVisible:!1,detailDialogVisible:!1,activeNodeIndex:0,editingWorkflow:null,workflows:[{id:1,name:"请假申请",description:"员工请假申请审批流程",status:"published",creator:"张三",createTime:"2023-05-01 10:00:00",color:"#409EFF",visibility:"public",nodes:[{id:1,name:"提交申请",assigneeType:"user",assignee:1},{id:2,name:"直属上级审批",assigneeType:"role",role:"manager"},{id:3,name:"人事审批",assigneeType:"role",role:"admin"}]},{id:2,name:"报销申请",description:"员工费用报销审批流程",status:"published",creator:"李四",createTime:"2023-05-05 14:30:00",color:"#67C23A",visibility:"public",nodes:[{id:1,name:"提交报销",assigneeType:"user",assignee:2},{id:2,name:"部门经理审批",assigneeType:"role",role:"manager"},{id:3,name:"财务审批",assigneeType:"role",role:"admin"}]},{id:3,name:"入职流程",description:"新员工入职办理流程",status:"draft",creator:"王五",createTime:"2023-05-10 09:15:00",color:"#E6A23C",visibility:"private",nodes:[{id:1,name:"填写入职信息",assigneeType:"user",assignee:3},{id:2,name:"部门分配",assigneeType:"role",role:"manager"},{id:3,name:"IT设备分配",assigneeType:"role",role:"admin"},{id:4,name:"人事手续办理",assigneeType:"role",role:"admin"}]}],users:[{id:1,name:"张三"},{id:2,name:"李四"},{id:3,name:"王五"},{id:4,name:"赵六"},{id:5,name:"钱七"}],workflowForm:{name:"",description:"",status:"draft",creator:"当前用户",color:"#409EFF",visibility:"public",nodes:[]},detailWorkflow:{},workflowRules:{name:[{required:!0,message:"请输入工作流名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},workflowInstances:[{id:1001,title:"张三的年假申请",currentNodeId:2,status:"in-progress",startTime:"2023-05-15 09:30:00"},{id:1002,title:"李四的差旅报销",currentNodeId:3,status:"in-progress",startTime:"2023-05-16 14:20:00"},{id:1003,title:"王五的病假申请",currentNodeId:1,status:"completed",startTime:"2023-05-10 11:45:00",endTime:"2023-05-10 16:30:00"}]}),computed:{filteredWorkflows(){let e=this.workflows;this.searchText&&(e=e.filter(e=>e.name.toLowerCase().includes(this.searchText.toLowerCase())||e.description.toLowerCase().includes(this.searchText.toLowerCase())));let l=(this.currentPage-1)*this.pageSize,a=l+this.pageSize;return e.slice(l,a)},myWorkflows(){return this.workflows.filter(e=>"张三"===e.creator)},participatedWorkflows(){return this.workflows.filter(e=>e.nodes.some(e=>"user"===e.assigneeType&&1===e.assignee||"role"===e.assigneeType&&"admin"===e.role))}},methods:{handleTabChange(e){this.activeTab=e,this.currentPage=1},handleSizeChange(e){this.pageSize=e,this.currentPage=1},handleCurrentChange(e){this.currentPage=e},getStatusText:e=>({draft:"草稿",published:"已发布",disabled:"已停用"})[e]||e,getStatusType:e=>({draft:"info",published:"success",disabled:"danger"})[e]||"info",getInstanceStatusText:e=>({pending:"待处理","in-progress":"进行中",completed:"已完成",rejected:"已拒绝"})[e]||e,getInstanceStatusType:e=>({pending:"info","in-progress":"warning",completed:"success",rejected:"danger"})[e]||"info",getRoleText:e=>({admin:"管理员",manager:"经理",employee:"员工"})[e]||e,getMyRole:e=>"张三"===e.creator?"创建者":"处理人",getUserById(e){return this.users.find(l=>l.id===e)},getCurrentNodeName(e){if(!this.detailWorkflow.nodes)return"";let l=this.detailWorkflow.nodes.find(l=>l.id===e);return l?l.name:""},showAddWorkflowDialog(){this.editingWorkflow=null,this.workflowForm={name:"",description:"",status:"draft",creator:"当前用户",color:"#409EFF",visibility:"public",nodes:[{id:Date.now(),name:"节点1",assigneeType:"user",assignee:1}]},this.workflowDialogVisible=!0,this.$nextTick(()=>{this.$refs.workflowFormRef.resetFields()})},editWorkflow(e){this.editingWorkflow=e,this.workflowForm=JSON.parse(JSON.stringify(e)),this.workflowDialogVisible=!0},viewWorkflow(e){this.detailWorkflow={...e},this.detailDialogVisible=!0},startWorkflow(e){this.$message.success(`已启动工作流: ${e.name}`)},processWorkflow(e){this.$message.success(`开始处理工作流: ${e.name}`)},deleteWorkflow(e){this.$confirm(`确定要删除工作流"${e.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l=this.workflows.findIndex(l=>l.id===e.id);-1!==l&&(this.workflows.splice(l,1),this.totalWorkflows=this.workflows.length,this.$message.success("工作流删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},saveWorkflow(){this.$refs.workflowFormRef.validate(e=>{if(e){if(this.editingWorkflow){let e=this.workflows.findIndex(e=>e.id===this.editingWorkflow.id);-1!==e&&(this.workflows[e]={...this.editingWorkflow,...this.workflowForm},this.$message.success("工作流更新成功"))}else{let e={id:Date.now(),createTime:new Date().toLocaleString(),...this.workflowForm};this.workflows.push(e),this.totalWorkflows=this.workflows.length,this.$message.success("工作流创建成功")}this.workflowDialogVisible=!1}})},addNode(){this.workflowForm.nodes.push({id:Date.now()+Math.random(),name:`节点${this.workflowForm.nodes.length+1}`,assigneeType:"user",assignee:1})},removeNode(e){if(this.workflowForm.nodes.length<=1)return void this.$message.warning("至少需要保留一个节点");this.workflowForm.nodes.splice(e,1)},viewInstance(e){this.$message.info(`查看实例: ${e.id}`)}}},N=a(96453),R=a.n(N),q=a(88072),j=a.n(q),A=a(71420),P=a.n(A),E=a(8900),L=a.n(E),Z=a(9911),B=a.n(Z),M=a(27264),H=a.n(M),J=a(14603),K={};K.styleTagTransform=H(),K.setAttributes=L(),K.insert=P().bind(null,"head"),K.domAPI=j(),K.insertStyleElement=B(),R()(J.Z,K),J.Z&&J.Z.locals&&J.Z.locals;var O=(0,a(50131).default)($,[["render",function(e,l,a,S,D,I){let $=(0,o.up)("Search"),N=(0,o.up)("el-icon"),R=(0,o.up)("el-input"),q=(0,o.up)("el-button"),j=(0,o.up)("Connection"),A=(0,o.up)("el-table-column"),P=(0,o.up)("el-tag"),E=(0,o.up)("el-table"),L=(0,o.up)("el-tab-pane"),Z=(0,o.up)("el-tabs"),B=(0,o.up)("el-pagination"),M=(0,o.up)("el-card"),H=(0,o.up)("el-form-item"),J=(0,o.up)("el-col"),K=(0,o.up)("el-option"),O=(0,o.up)("el-select"),Y=(0,o.up)("el-color-picker"),Q=(0,o.up)("el-row"),G=(0,o.up)("el-divider"),X=(0,o.up)("Rank"),ee=(0,o.up)("draggable"),el=(0,o.up)("el-form"),ea=(0,o.up)("el-dialog"),eo=(0,o.up)("el-descriptions-item"),et=(0,o.up)("el-descriptions"),ei=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)("div",t,[(0,o.Wm)(M,{shadow:"never"},{header:(0,o.w5)(()=>[(0,o._)("div",i,[l[17]||(l[17]=(0,o._)("span",null,"工作流",-1)),(0,o._)("div",r,[(0,o.Wm)(R,{modelValue:D.searchText,"onUpdate:modelValue":l[0]||(l[0]=e=>D.searchText=e),placeholder:"搜索工作流...",clearable:"",style:{width:"200px","margin-right":"10px"}},{prefix:(0,o.w5)(()=>[(0,o.Wm)(N,null,{default:(0,o.w5)(()=>[(0,o.Wm)($)]),_:1})]),_:1},8,["modelValue"]),(0,o.Wm)(q,{type:"primary",onClick:I.showAddWorkflowDialog},{default:(0,o.w5)(()=>[...l[16]||(l[16]=[(0,o.Uk)("创建工作流",-1)])]),_:1},8,["onClick"])])])]),default:(0,o.w5)(()=>[(0,o.Wm)(Z,{modelValue:D.activeTab,"onUpdate:modelValue":l[1]||(l[1]=e=>D.activeTab=e),onTabChange:I.handleTabChange},{default:(0,o.w5)(()=>[(0,o.Wm)(L,{label:"所有工作流",name:"all"},{default:(0,o.w5)(()=>[(0,o.wy)(((0,o.wg)(),(0,o.j4)(E,{data:I.filteredWorkflows,style:{width:"100%"},"row-key":"id"},{default:(0,o.w5)(()=>[(0,o.Wm)(A,{prop:"name",label:"工作流名称","min-width":"200"},{default:(0,o.w5)(({row:e})=>[(0,o._)("div",d,[(0,o.Wm)(N,{color:e.color},{default:(0,o.w5)(()=>[(0,o.Wm)(j)]),_:2},1032,["color"]),(0,o._)("span",n,(0,o.zw)(e.name),1)])]),_:1}),(0,o.Wm)(A,{prop:"description",label:"描述","min-width":"250"},{default:(0,o.w5)(({row:e})=>[(0,o._)("div",s,(0,o.zw)(e.description),1)]),_:1}),(0,o.Wm)(A,{label:"状态",width:"100"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(P,{type:I.getStatusType(e.status)},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(I.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,o.Wm)(A,{prop:"creator",label:"创建者",width:"120"}),(0,o.Wm)(A,{prop:"createTime",label:"创建时间",width:"180"}),(0,o.Wm)(A,{label:"操作",width:"250"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(q,{type:"text",onClick:l=>I.viewWorkflow(e)},{default:(0,o.w5)(()=>[...l[18]||(l[18]=[(0,o.Uk)("查看",-1)])]),_:2},1032,["onClick"]),(0,o.Wm)(q,{type:"text",onClick:l=>I.editWorkflow(e)},{default:(0,o.w5)(()=>[...l[19]||(l[19]=[(0,o.Uk)("编辑",-1)])]),_:2},1032,["onClick"]),(0,o.Wm)(q,{type:"text",onClick:l=>I.startWorkflow(e)},{default:(0,o.w5)(()=>[...l[20]||(l[20]=[(0,o.Uk)("启动",-1)])]),_:2},1032,["onClick"]),(0,o.Wm)(q,{type:"text",onClick:l=>I.deleteWorkflow(e)},{default:(0,o.w5)(()=>[...l[21]||(l[21]=[(0,o.Uk)("删除",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ei,D.loading]])]),_:1}),(0,o.Wm)(L,{label:"我创建的",name:"created"},{default:(0,o.w5)(()=>[(0,o.Wm)(E,{data:I.myWorkflows,style:{width:"100%"},"row-key":"id"},{default:(0,o.w5)(()=>[(0,o.Wm)(A,{prop:"name",label:"工作流名称","min-width":"200"},{default:(0,o.w5)(({row:e})=>[(0,o._)("div",w,[(0,o.Wm)(N,{color:e.color},{default:(0,o.w5)(()=>[(0,o.Wm)(j)]),_:2},1032,["color"]),(0,o._)("span",m,(0,o.zw)(e.name),1)])]),_:1}),(0,o.Wm)(A,{prop:"description",label:"描述","min-width":"250"}),(0,o.Wm)(A,{label:"状态",width:"100"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(P,{type:I.getStatusType(e.status)},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(I.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,o.Wm)(A,{prop:"createTime",label:"创建时间",width:"180"}),(0,o.Wm)(A,{label:"操作",width:"200"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(q,{type:"text",onClick:l=>I.viewWorkflow(e)},{default:(0,o.w5)(()=>[...l[22]||(l[22]=[(0,o.Uk)("查看",-1)])]),_:2},1032,["onClick"]),(0,o.Wm)(q,{type:"text",onClick:l=>I.editWorkflow(e)},{default:(0,o.w5)(()=>[...l[23]||(l[23]=[(0,o.Uk)("编辑",-1)])]),_:2},1032,["onClick"]),(0,o.Wm)(q,{type:"text",onClick:l=>I.startWorkflow(e)},{default:(0,o.w5)(()=>[...l[24]||(l[24]=[(0,o.Uk)("启动",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),(0,o.Wm)(L,{label:"我参与的",name:"participated"},{default:(0,o.w5)(()=>[(0,o.Wm)(E,{data:I.participatedWorkflows,style:{width:"100%"},"row-key":"id"},{default:(0,o.w5)(()=>[(0,o.Wm)(A,{prop:"name",label:"工作流名称","min-width":"200"},{default:(0,o.w5)(({row:e})=>[(0,o._)("div",u,[(0,o.Wm)(N,{color:e.color},{default:(0,o.w5)(()=>[(0,o.Wm)(j)]),_:2},1032,["color"]),(0,o._)("span",f,(0,o.zw)(e.name),1)])]),_:1}),(0,o.Wm)(A,{prop:"description",label:"描述","min-width":"250"}),(0,o.Wm)(A,{label:"我的角色",width:"120"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(P,null,{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(I.getMyRole(e)),1)]),_:2},1024)]),_:1}),(0,o.Wm)(A,{label:"状态",width:"100"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(P,{type:I.getStatusType(e.status)},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(I.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,o.Wm)(A,{prop:"creator",label:"创建者",width:"120"}),(0,o.Wm)(A,{label:"操作",width:"150"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(q,{type:"text",onClick:l=>I.viewWorkflow(e)},{default:(0,o.w5)(()=>[...l[25]||(l[25]=[(0,o.Uk)("查看",-1)])]),_:2},1032,["onClick"]),(0,o.Wm)(q,{type:"text",onClick:l=>I.processWorkflow(e)},{default:(0,o.w5)(()=>[...l[26]||(l[26]=[(0,o.Uk)("处理",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue","onTabChange"]),(0,o._)("div",p,[(0,o.Wm)(B,{"current-page":D.currentPage,"onUpdate:currentPage":l[2]||(l[2]=e=>D.currentPage=e),"page-size":D.pageSize,"onUpdate:pageSize":l[3]||(l[3]=e=>D.pageSize=e),"page-sizes":[10,20,50,100],total:D.totalWorkflows,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I.handleSizeChange,onCurrentChange:I.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),(0,o.kq)(" 添加/编辑工作流对话框 "),(0,o.Wm)(ea,{modelValue:D.workflowDialogVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>D.workflowDialogVisible=e),title:D.editingWorkflow?"编辑工作流":"创建工作流",width:"800px"},{footer:(0,o.w5)(()=>[(0,o._)("span",_,[(0,o.Wm)(q,{onClick:l[11]||(l[11]=e=>D.workflowDialogVisible=!1)},{default:(0,o.w5)(()=>[...l[29]||(l[29]=[(0,o.Uk)("取消",-1)])]),_:1}),(0,o.Wm)(q,{type:"primary",onClick:I.saveWorkflow},{default:(0,o.w5)(()=>[...l[30]||(l[30]=[(0,o.Uk)(" 保存 ",-1)])]),_:1},8,["onClick"])])]),default:(0,o.w5)(()=>[(0,o.Wm)(el,{ref:"workflowFormRef",model:D.workflowForm,rules:D.workflowRules,"label-width":"100px"},{default:(0,o.w5)(()=>[(0,o.Wm)(Q,{gutter:20},{default:(0,o.w5)(()=>[(0,o.Wm)(J,{span:12},{default:(0,o.w5)(()=>[(0,o.Wm)(H,{label:"工作流名称",prop:"name"},{default:(0,o.w5)(()=>[(0,o.Wm)(R,{modelValue:D.workflowForm.name,"onUpdate:modelValue":l[4]||(l[4]=e=>D.workflowForm.name=e)},null,8,["modelValue"])]),_:1}),(0,o.Wm)(H,{label:"描述",prop:"description"},{default:(0,o.w5)(()=>[(0,o.Wm)(R,{modelValue:D.workflowForm.description,"onUpdate:modelValue":l[5]||(l[5]=e=>D.workflowForm.description=e),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),(0,o.Wm)(H,{label:"创建者"},{default:(0,o.w5)(()=>[(0,o.Wm)(R,{modelValue:D.workflowForm.creator,"onUpdate:modelValue":l[6]||(l[6]=e=>D.workflowForm.creator=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.Wm)(J,{span:12},{default:(0,o.w5)(()=>[(0,o.Wm)(H,{label:"状态"},{default:(0,o.w5)(()=>[(0,o.Wm)(O,{modelValue:D.workflowForm.status,"onUpdate:modelValue":l[7]||(l[7]=e=>D.workflowForm.status=e),placeholder:"请选择状态",style:{width:"100%"}},{default:(0,o.w5)(()=>[(0,o.Wm)(K,{label:"草稿",value:"draft"}),(0,o.Wm)(K,{label:"已发布",value:"published"}),(0,o.Wm)(K,{label:"已停用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),(0,o.Wm)(H,{label:"工作流颜色"},{default:(0,o.w5)(()=>[(0,o.Wm)(Y,{modelValue:D.workflowForm.color,"onUpdate:modelValue":l[8]||(l[8]=e=>D.workflowForm.color=e)},null,8,["modelValue"])]),_:1}),(0,o.Wm)(H,{label:"可见范围"},{default:(0,o.w5)(()=>[(0,o.Wm)(O,{modelValue:D.workflowForm.visibility,"onUpdate:modelValue":l[9]||(l[9]=e=>D.workflowForm.visibility=e),placeholder:"请选择可见范围",style:{width:"100%"}},{default:(0,o.w5)(()=>[(0,o.Wm)(K,{label:"所有人",value:"public"}),(0,o.Wm)(K,{label:"仅创建者",value:"private"}),(0,o.Wm)(K,{label:"指定部门",value:"department"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,o.Wm)(G,null,{default:(0,o.w5)(()=>[...l[27]||(l[27]=[(0,o.Uk)("流程节点",-1)])]),_:1}),(0,o._)("div",c,[(0,o.Wm)(ee,{modelValue:D.workflowForm.nodes,"onUpdate:modelValue":l[10]||(l[10]=e=>D.workflowForm.nodes=e),"item-key":"id",handle:".node-handle"},{item:(0,o.w5)(({element:e,index:l})=>[(0,o._)("div",g,[(0,o._)("div",k,[(0,o.Wm)(N,null,{default:(0,o.w5)(()=>[(0,o.Wm)(X)]),_:1})]),(0,o._)("div",b,[(0,o.Wm)(H,{prop:`nodes.${l}.name`,rules:[{required:!0,message:"请输入节点名称",trigger:"blur"}]},{default:(0,o.w5)(()=>[(0,o.Wm)(R,{modelValue:e.name,"onUpdate:modelValue":l=>e.name=l,placeholder:"节点名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),(0,o.Wm)(H,{prop:`nodes.${l}.assigneeType`,rules:[{required:!0,message:"请选择处理人类型",trigger:"change"}]},{default:(0,o.w5)(()=>[(0,o.Wm)(O,{modelValue:e.assigneeType,"onUpdate:modelValue":l=>e.assigneeType=l,placeholder:"处理人类型",style:{width:"100%"}},{default:(0,o.w5)(()=>[(0,o.Wm)(K,{label:"指定人员",value:"user"}),(0,o.Wm)(K,{label:"指定角色",value:"role"}),(0,o.Wm)(K,{label:"表单字段",value:"field"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),"user"===e.assigneeType?((0,o.wg)(),(0,o.j4)(H,{key:0,prop:`nodes.${l}.assignee`,rules:[{required:!0,message:"请选择处理人",trigger:"change"}]},{default:(0,o.w5)(()=>[(0,o.Wm)(O,{modelValue:e.assignee,"onUpdate:modelValue":l=>e.assignee=l,placeholder:"处理人",style:{width:"100%"}},{default:(0,o.w5)(()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(D.users,e=>((0,o.wg)(),(0,o.j4)(K,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(0,o.kq)("v-if",!0),"role"===e.assigneeType?((0,o.wg)(),(0,o.j4)(H,{key:1,prop:`nodes.${l}.role`,rules:[{required:!0,message:"请选择角色",trigger:"change"}]},{default:(0,o.w5)(()=>[(0,o.Wm)(O,{modelValue:e.role,"onUpdate:modelValue":l=>e.role=l,placeholder:"角色",style:{width:"100%"}},{default:(0,o.w5)(()=>[(0,o.Wm)(K,{label:"管理员",value:"admin"}),(0,o.Wm)(K,{label:"经理",value:"manager"}),(0,o.Wm)(K,{label:"员工",value:"employee"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(0,o.kq)("v-if",!0)]),(0,o._)("div",h,[(0,o.Wm)(q,{type:"danger",icon:"Delete",circle:"",onClick:e=>I.removeNode(l)},null,8,["onClick"])])])]),_:1},8,["modelValue"]),(0,o._)("div",W,[(0,o.Wm)(q,{type:"primary",onClick:I.addNode},{default:(0,o.w5)(()=>[...l[28]||(l[28]=[(0,o.Uk)("添加节点",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),(0,o.kq)(" 工作流详情对话框 "),(0,o.Wm)(ea,{modelValue:D.detailDialogVisible,"onUpdate:modelValue":l[15]||(l[15]=e=>D.detailDialogVisible=e),title:"工作流详情",width:"800px"},{footer:(0,o.w5)(()=>[(0,o._)("span",F,[(0,o.Wm)(q,{onClick:l[14]||(l[14]=e=>D.detailDialogVisible=!1)},{default:(0,o.w5)(()=>[...l[32]||(l[32]=[(0,o.Uk)("关闭",-1)])]),_:1})])]),default:(0,o.w5)(()=>[(0,o.Wm)(Q,{gutter:20},{default:(0,o.w5)(()=>[(0,o.Wm)(J,{span:16},{default:(0,o.w5)(()=>[(0,o.Wm)(et,{column:1,border:""},{default:(0,o.w5)(()=>[(0,o.Wm)(eo,{label:"工作流名称"},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(D.detailWorkflow.name),1)]),_:1}),(0,o.Wm)(eo,{label:"描述"},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(D.detailWorkflow.description),1)]),_:1}),(0,o.Wm)(eo,{label:"创建者"},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(D.detailWorkflow.creator),1)]),_:1}),(0,o.Wm)(eo,{label:"状态"},{default:(0,o.w5)(()=>[(0,o.Wm)(P,{type:I.getStatusType(D.detailWorkflow.status)},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(I.getStatusText(D.detailWorkflow.status)),1)]),_:1},8,["type"])]),_:1}),(0,o.Wm)(eo,{label:"创建时间"},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(D.detailWorkflow.createTime),1)]),_:1})]),_:1})]),_:1}),(0,o.Wm)(J,{span:8},{default:(0,o.w5)(()=>[(0,o._)("div",{class:"workflow-icon-detail",style:(0,o.j5)({color:D.detailWorkflow.color})},[(0,o.Wm)(N,{size:60},{default:(0,o.w5)(()=>[(0,o.Wm)(j)]),_:1})],4)]),_:1})]),_:1}),(0,o.Wm)(Z,{modelValue:D.workflowActiveTab,"onUpdate:modelValue":l[13]||(l[13]=e=>D.workflowActiveTab=e),style:{"margin-top":"20px"}},{default:(0,o.w5)(()=>[(0,o.Wm)(L,{label:"流程图",name:"diagram"},{default:(0,o.w5)(()=>[(0,o._)("div",y,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(D.detailWorkflow.nodes,(e,l)=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:(0,o.C_)(["workflow-node",{active:D.activeNodeIndex===l}]),onClick:e=>D.activeNodeIndex=l},[(0,o._)("div",x,(0,o.zw)(l+1),1),(0,o._)("div",T,(0,o.zw)(e.name),1),(0,o._)("div",V,["user"===e.assigneeType?((0,o.wg)(),(0,o.iD)("span",C," 处理人: "+(0,o.zw)(I.getUserById(e.assignee)?.name||"未指定"),1)):"role"===e.assigneeType?((0,o.wg)(),(0,o.iD)("span",U," 角色: "+(0,o.zw)(I.getRoleText(e.role)),1)):((0,o.wg)(),(0,o.iD)("span",z," 字段: "+(0,o.zw)(e.field||"未指定"),1))])],10,v))),128))])]),_:1}),(0,o.Wm)(L,{label:"实例",name:"instances"},{default:(0,o.w5)(()=>[(0,o.Wm)(E,{data:D.workflowInstances,style:{width:"100%"}},{default:(0,o.w5)(()=>[(0,o.Wm)(A,{prop:"id",label:"实例ID",width:"100"}),(0,o.Wm)(A,{prop:"title",label:"标题"}),(0,o.Wm)(A,{label:"当前节点",width:"150"},{default:(0,o.w5)(({row:e})=>[(0,o.Uk)((0,o.zw)(I.getCurrentNodeName(e.currentNodeId)),1)]),_:1}),(0,o.Wm)(A,{label:"状态",width:"100"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(P,{type:I.getInstanceStatusType(e.status)},{default:(0,o.w5)(()=>[(0,o.Uk)((0,o.zw)(I.getInstanceStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,o.Wm)(A,{prop:"startTime",label:"开始时间",width:"180"}),(0,o.Wm)(A,{label:"操作",width:"150"},{default:(0,o.w5)(({row:e})=>[(0,o.Wm)(q,{type:"text",onClick:l=>I.viewInstance(e)},{default:(0,o.w5)(()=>[...l[31]||(l[31]=[(0,o.Uk)("查看",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}],["__scopeId","data-v-58babf0a"]])}}]);